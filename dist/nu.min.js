/*! nu 2014-02-21 */
var nu={random:{id:function(a){a=angular.extend({pool:"0123456789abcdefghiklmnopqrstuvwxyz",size:8},a);for(var b="",c=0;c<a.size;c++)b+=a.pool[Math.floor(Math.random()*a.pool.length)];return b}},attr:{move:function(a,b,c){for(var d=0;d<c.length;d++)a.attr(c[d],b.attr(c[d])),b.removeAttr(c[d]);return a}},"switch":function(a,b,c){return b&&c?a?b:c:a}};!function(a){"use strict";var b=a.module("nu.list",[]);b.directive("nuList",["$parse",function(b){return{template:'<div class="nu list"></div>',restrict:"EACM",replace:!0,controller:["$scope","$element","$attrs",function(c,d,e){this.$render=a.noop,this.$filter=a.noop,this.$link=a.noop;var f=this.$srcVar=e[e.nuList?"nuList":"src"],g=this.$src=b(f)(c),h=this.$onRender=null,i=this.$onAppend=null;e.$observe("onRender",function(a){h=b(a)(c)}),e.$observe("onAppend",function(a){i=b(a)(c)}),this.$add=function(a){h&&(a=i(a)),a&&g.push(a)},this.$remove=function(a){c.$apply(function(){g.splice(a,1)})};var j=this,k=this.$draw=function(b){var c=a.element(d);a.forEach(b,function(c,d){if(this.$onAppend&&(b=j.$onAppend(b)),c){var e=j.$render(c);e&&(a.element(e).data("index",d),j.$link(e),this.append(e))}},c.html(""))};this.$redraw=function(){c.apply(function(){k(g)})}}],link:function(a,b,c,d){a.$watchCollection(d.$srcVar,d.$draw)}}}]),b.directive("nuListType",["$compile",function(){var b=function(b){return a.element('<span class="item thumb"><img src="'+b+'"></img></span>')},c=function(b){return a.element('<span class="item">'+b+"</span>")};return{restrict:"A",require:"nuList",link:function(a,d,e,f){f.$render="img"===e.nuListType?b:c}}}]),b.directive("nuListRemovable",["$compile",function(){return{restrict:"A",require:"nuList",link:function(b,c,d,e){var f=function(b){e.$remove(a.element(b.currentTarget).data("index"))};e.$link=function(a){a.addClass("remove").on("click",f)}}}}]),b.directive("nuListAddable",["$timeout",function(){var b=function(b,c,d,e){var f=a.element('<label class="buffer img"></label>'),g=a.element('<input type="file" multiple>');f.append(g);var h=null,i=function(a){e.$add(a.target.result),a.target===h&&(h=null,b.$digest())};return g.on("change",function(){for(var a=this,b=0;b<a.files.length;b++){var c=a.files[b];c.type.match(/image.*/)&&(h=new FileReader,h.onload=i,h.readAsDataURL(c))}}),f},c=function(b,c,d,e){var f=a.element('<span contenteditable="true" class="buffer">Â </span>');return f.on("keydown",function(a){var c=a.which||a.keyCode;if(13===c){var d=this.innerHTML.replace("&nbsp;","").trim();this.blur(),a.preventDefault(),""!==d&&d&&b.$apply(function(){e.$add(d)})}}),f};return{restrict:"A",require:"nuList",link:function(a,d,e,f){var g=f.$draw;f.$draw=function(){var h=("img"===e.nuListType?b:c)(a,d,e,f);g.apply(this,arguments),d.append(h)}}}}])}(angular),function(a,b){"use strict";var c=a.module("nu.pb",[]);c.directive("nuPressButton",[function(){var c='<div class="nu button press"><input class="src" type="checkbox" autocomplete="off" style="display:none;"><label icon="Off"></label><label icon="On"></label></div>';return{template:c,restrict:"EACM",replace:!0,require:"?ngModel",compile:function(c,d){var e=d.id,f=c.find("input"),g=c.find("label");e?c.removeAttr("id"):e=b.random.id(),b.attr.move(f,c,["type","name","checked"]).attr("id",e),g.attr("for",e);var h=function(b,c,d,e){d.$observe("iconOn",function(b){a.element(g[0]).attr("class",(d.icon?d.icon:"")+(b?" "+b:""))}),d.$observe("iconOff",function(b){a.element(g[1]).attr("class",(d.icon?d.icon:"")+(b?" "+b:""))}),e&&(e.$formatters.push(function(b){return a.isDefined(d.value)&&b===d.value||b===!0}),e.$parsers.push(function(a){return d.value?a?d.value:d.valueOff:a}),e.$isEmpty=function(a){return a!==d.value},e.$render=function(){f[0].checked=e.$viewValue},f.on("change",function(a){var c=this.checked;a.stopPropagation(),("radio"!==this.type||c)&&b.$apply(function(){e.$setViewValue(c)})}),a.isDefined(b[d.ngModel])?e.$setViewValue(b[d.ngModel]):f[0].defaultChecked&&e.$setViewValue(f[0].checked))};return h}}}])}(angular,nu),function(a,b){"use strict";var c=a.module("nu.switch",[]);c.directive("nuSwitch",[function(){var c='<div class="nu switch"><input class="src" type="checkbox" autocomplete="off"><label class="label"></label></div>';return{template:c,restrict:"EACM",replace:!0,require:"?ngModel",compile:function(c,d){var e=d.id,f=c.find("input"),g=c.find("label");e?c.removeAttr("id"):e=b.random.id(),b.attr.move(f,c,["type","name","checked"]).attr("id",e),g.attr("for",e),d.$observe("on",function(a){g.text(a?a:"On")}),d.$observe("off",function(a){g.attr("label-off",a?a:"Off")});var h=function(b,c,d,e){e&&(e.$formatters.push(function(b){return a.isDefined(d.value)&&b===d.value||b===!0}),e.$parsers.push(function(a){return d.value?a?d.value:d.valueOff:a}),e.$isEmpty=function(a){return a!==d.value},e.$render=function(){f[0].checked=e.$viewValue},f.on("change",function(a){a.stopPropagation();var c=this.checked;("radio"!==this.type||c)&&(e.$setViewValue(c),b.$digest())}),a.isDefined(b[d.ngModel])?e.$setViewValue(b[d.ngModel]):f[0].defaultChecked&&e.$setViewValue(f[0].checked))};return h}}}])}(angular,nu),function(a){"use strict";var b=a.module("nu.file.chooser",[]),c=/\.([\w\d]+)$/i,d=/([^\\\/]+)$/,e=function(a){var b=["",""];return function(c){if(c){var d=c.split(a);return d?d.splice(0,2):b}return b}},f=e(c),g=e(d),h=function(a){return g(a)[1]};b.directive("nuFileChooser",["$parse",function(b){var c='<label class="nu file chooser" style="position: relative;"><input type="file"/>{{path}}<a ng-click="clear()" class="remove"></a></label>';return{template:c,restrict:"EACM",replace:!0,scope:{},controller:["$scope","$element","$attrs",function(c,d,e){this.$guess_type=null;var g=this,i=function(a){return function(b){c.path!==b&&(g.$toSrc&&(b=g.$toSrc(b)),a(c.$parent,b))}};this.$put_src=a.noop,this.$onSelection=a.noop,this.$onClear=a.noop,this.$toPath=function(a){return a&&a.name?a.name:a},this.$toSrc=null,e.$observe("src",function(e){g.$put_src=a.noop;var j="",k="select";if(e){var l=b(e);c.path=h(g.$toPath(l(c.$parent))),l.assign&&(g.$put_src=i(l.assign)),c.path&&""!==c.path.trim()&&(j=f(c.path).pop(),k="selected")}d.attr("ext",j),d.attr("state",k)})}],compile:function(a){var b=a.find("input"),c=function(b,c,d){a.attr("ext",b),a.attr("mime",c),a.attr("state",d)},d=function(a,d,e,g){var h=function(b){var d="",e="",h=null,i="select";b.target.files.length>0&&(h=b.target.files[0],d=f(h.name)[1].toLowerCase(),e=h.type,g.$guess_type&&(e=g.$guess_type.call(h,e,h.name,d)),i="selected"),a.$apply(function(a){a.path=h?h.name:"",g.$put_src(h)}),c(d,e,i)};b.on("change",h),a.clear=function(){a.path="",g.$put_src(null),c("","","selected")}};return d}}}])}(angular);