/*! nu 2014-04-29 */
!function(a){"use strict";function b(a){return"undefined"!=typeof a&&null!==a}function c(a){return t(a)?a.replace(/^\s+|\s+$/g,""):""}function d(a,b){return t(a)&&t(b)&&0===a.indexOf(b)}function e(a){if(a&&t(a)){var b=a.toLowerCase();return!("false"===b||"f"===b||"off"===b)}return a===!0}function f(a){return a&&a.lastModifiedDate&&t(a.type)}function g(b,c,d,e,f,g){var h=d.id,i=c.find("input"),j=c.find("label"),k=d.ngTrueValue,n=d.ngFalseValue;if(e=e||B,h?c.removeAttr("id"):h=m.id(),l.attribute(i,c,["type","name","checked"]).attr("id",h),j.attr("for",h),(!e.$isEmpty(t(k)?k:!0)||e.isNull)&&(e.$isEmpty=function(a){return a!==k},e.$formatters.push(function(a){return k?a===k:a}),e.$parsers.push(function(a){return k?a?k:n:a})),c.off("click"),i.off("click"),e.$render=function(){i[0].checked=e.$viewValue},i[0].defaultChecked&&i[0].checked&&e.$setViewValue(!0),!e.isNull&&a.isDefined(g)){var o;t(g)?(g===k&&(o=!0),g===n&&(o=!1)):o=g,o&&(e.$setViewValue(o),e.$render())}i.on("change",function(a){var c=this.checked;a.stopPropagation(),("radio"!==this.type||c)&&(e.$setViewValue(c),e.isNull||b.$digest()),f.trigger("change",{target:d.name,value:e.$modelValue})}),d.$observe("disabled",function(b){a.isDefined(b)&&"false"!==b?i.attr("disabled",b):i.removeAttr("disabled")})}function h(a){return function(b){return"."===b[0]&&-1!==R[a].indexOf(b)}}var i="ng-pristine",j="ng-dirty",k=/([^\\\/]+)$/,l={},m={},n={},o={},p=a.noop,q=(a.copy,a.equals,a.forEach),r=a.isArray,s=a.isObject,t=a.isString,u=(a.isElement,a.isFunction),v=a.isUndefined,w=a.lowercase,x=a.extend,y=a.$$minErr("nu");o.splitext=function(a){var b=o.basename(a),c=b.lastIndexOf(".");return-1===c?[b,""]:[b.substr(0,c),b.substr(c)]},o.basename=function(a){var b=k.exec(a);return b?b[1]:a},m.defaults={pool:"0123456789abcdefghiklmnopqrstuvwxyz",size:8},m.id=function(a){a=x(m.defaults,a);for(var b="",c=0;c<a.size;c++)b+=a.pool[Math.floor(Math.random()*a.pool.length)];return b},l.attribute=function(a,b,c){for(var d=0;d<c.length;d++)a.attr(c[d],b.attr(c[d])),b.removeAttr(c[d]);return a},n.move=l,n.append={},n.append.text=function(a,b,c){var d=document.createTextNode(b);return a.insertBefore(d,c),d};var z=function(a,b,c,d){var e=a.$$watchers.length,f=b.$render,g=m.id(),h=!1;for(d(a,g),b.$render=function(){h=!0};e--&&(a.$$watchers[e].get!==a.$$watchers[e].exp||(a.$$watchers[e].get(),!h)););return b.$render=f,d(a,c),a.$$watchers[e]},A=function(){var a=function(){this.events={}};return a.prototype.on=function(a,b){this.events[a]||(this.events[a]=[]),this.events[a].push(b)},a.prototype.off=function(a){if(this.events[a]){var b=this.events[a].indexOf;if(-1!==b)return this.events[a].split(b,1)[0]}},a.prototype.trigger=function(a,b){return this.events[a]&&q(this.events[a],function(a){a(b)}),b},a}(q),B={$isEmpty:a.identity,$formatters:[],$parsers:[],$setViewValue:function(a){q(this.$parsers,function(b){a=b(a)}),this.$modelValue=a},isNull:!0},C=a.module("nu.List",[]),D=["$scope","$element","$exceptionHandler","$attrs","$compile","$parse",function(c,d,e,f,g,h){var k=this,l=[],m=d[0],n=m.children,o=parseInt(f.capacity)||10,r=f.nuList||f.src,s=h(r),t=s.assign,u=!1,v=(parseInt(f.min),parseInt(f.max),function(a){return m.insertBefore(a,k.$buffers[0])});this.$dirty=!1,this.$pristine=!0,this.$viewValue=[],this.$modelValue=Number.NaN,this.$render=p,this.$name=f.name,this.$buffers=[],this.$parsers=[],this.$formatters=[],this.$defaults=x(c.$new(),{$erase:function(){k.$removeItem(this.item)}}),this.$bufferDefaults=x(c.$new(),{$append:function(a){k.$itemNodeFactory({item:a,$index:k.$viewValue.length}),k.$updateViewValue(k.$viewValue.push(a))},$update:function(b,c){a.element(n[b]).scope().item=c,k.$updateViewValue(k.$viewValue[b]=c)}}),this.$getItems=function(){return Array.prototype.slice.call(n,0)},d.addClass(i),c.$watch(function(c){if(!u){var d=s(c);k.$modelValue=d;for(var e=k.$formatters.length;e--;)d=k.$formatters[e](d);b(d)?k.$viewValue=d:k.$viewValue.splice(0),l=k.$getItems(),k.$render(),a.element(l.splice(o-1)).remove(),a.element(l).css("display","none")}u=!1}),this.$itemCompiler=g('<span class="list item erase" ng-click="$erase(item)">{{item}}</span>'),this.$itemNodeFactory=function(b){var c=a.element(l.shift()||k.$itemCompiler(k.$defaults.$new(),function(a){v(a[0])}));return x(c.scope(),b),c.css("display","")},this.$removeItem=function(b){var c=this.$viewValue.indexOf(b);n.length>c&&(k.$viewValue.splice(c,1),a.element(n[c]).css("display","none"),v(n[c]),l.push(n[c])),k.$updateViewValue()},this.$setDirty=function(){k.$pristine=!1,k.$dirty=!0,d.removeClass(i).addClass(j)},this.$setPristine=function(){k.$pristine=!0,k.$dirty=!1,d.removeClass(j).addClass(i)},this.$updateViewValue=function(){if(k.$pristine&&k.$setDirty(),t){u=!0;var a=k.$viewValue;q(k.$parsers,function(b){a=b(a)}),t(c,a)}}}];C.service("listBuffers",function(){var b={};b.txt=function(a,b){a.attr("contenteditable","true"),a.on("keydown",function(a){var d=a.which||a.keyCode;if(13===d){var e=c(this.innerHTML).replace(/<br\/?>/gi,"");this.innerHTML="",a.preventDefault(),e&&b.$apply(function(a){a.$append(e)})}}).html("")},b.file=function(a,b){var c=a.find("input");c.on("change",function(a){var c=a.target.files;c.length>0&&(a.preventDefault(),b.$apply(function(a){for(var b=0;b<c.length;b++)a.$append(c[b])}),this.value="")})},b.default=p,this.compile=function(c,d){var e=a.element(c.replace(/(<\/?)buffer/gi,"$1span")),f=e.attr("type")||"default";return b[f]||(f="default"),b[f](e,d),e},this.type=function(a,c){return c&&(b[a]=c),b[a]}}),C.directive("nuList",["$compile","$parse","listBuffers",function(b,e,f){return{terminal:!0,priority:95,template:'<div class="nu list"></div>',replace:!0,transclude:"element",restrict:"EACM",controller:D,link:function(e,g,h,i,j){var k=j();k.scope().$destroy(),g.data("$nuListController",i);var l=k.find("buffer").remove(),m=c(k.html()),n=g[0].children;if(m&&(d(m,"<")||(m='<span ng-click="$erase(item)">'+m+"</span>"),i.$itemCompiler=b(m)),l.length>0){if(l.find("buffer").length>0)throw y("list","Nested buffers are not allowed");a.forEach(l,function(a){var d=i.$bufferDefaults.$new(),e=b(f.compile(c(a.outerHTML),d))(d).addClass("buffer");i.$buffers.push(e[0])}),g.append(i.$buffers),i.$getItems=function(){return Array.prototype.slice.call(n,0,-l.length)}}var o=function(){i.$removeItem(this.item)};h.$observe("readonly",function(a){i.$defaults.$erase="readonly"===a||"true"===a?p:o,i.$defaults.$erase!==p&&g.attr("readonly","")}),h.$observe("buffer",function(b){var c=a.element(i.$buffers);"false"===b?c.addClass("hidden-buffer"):c.removeClass("hidden-buffer")}),i.$buffers[0]&&g.on("click",function(){i.$buffers[0].focus()}),i.$render=function(){q(i.$viewValue,function(a,b){i.$itemNodeFactory({item:a,$index:b})})}}}}]);var E=a.module("nu.PressButton",["nu.Event"]);E.directive("nuPressButton",["nuEvent","$parse",function(b,c){var d='<div class="nu button press"><input class="src" type="checkbox" autocomplete="off" style="display:none;"><label icon="Off"></label><label icon="On"></label></div>';return{template:d,restrict:"EACM",replace:!0,require:"?ngModel",priority:5,link:function(d,e,f,h){var i=f.nuPressButton||f.icon,j=e.find("label");a.element(j[1]).attr("class",(i?i:"")+(f.on?" "+f.on:"")),a.element(j[0]).attr("class",(i?i:"")+(f.off?" "+f.off:"")),g(d,e,f,h,b(d,f),c(f.ngModel)(d))}}}]);var F=a.module("nu.Switch",["nu.Event"]);F.directive("nuSwitch",["nuEvent","$parse",function(a,b){var c='<div class="nu switch"><input class="src" type="checkbox" autocomplete="off"><label class="label"></label></div>';return{template:c,restrict:"EACM",replace:!0,require:"?ngModel",priority:5,link:function(c,d,e,f){var h=d.find("label");h.text(e.on?e.on:"On"),h.attr("label-off",e.off?e.off:"Off"),g(c,d,e,f,a(c,e),b(e.ngModel)(c))}}}]);var G=a.module("nu.FileChooser",["nu.List","nu.Event","nu.Media"]);G.filter("basename",function(){return function(a){return f(a)&&(a=a.name),t(a)?o.basename(a):a}}),G.filter("pathExt",function(){return function(a){return f(a)&&(a=a.name),t(a)?w(o.splitext(a)[1]).substr(1):a}}),G.directive("nuFileChooser",["$compile","listBuffers","nuEvent",function(b,d){var e='<span class="list item" ext="{{item|pathExt}}" ng-click="$erase()">{{item|basename}}</span>',f='<label class="buffer" type="file"><span class="action">Browse<input type="file"></span></label>';return{restrict:"AC",require:"nuList",priority:99,link:function(g,h,i,j){var k,l=h[0],m=l.children,n=j.$bufferDefaults.$new(),o=h.hasClass("multiple"),p=a.element(e);0===j.$buffers.length?(k=b(d.compile(c(f),n))(n),j.$buffers.push(k[0])):k=a.element(j.$buffers[0]),j.$itemCompiler=b(p),h.append(j.$buffers).addClass("file"),j.$getItems=function(){return Array.prototype.slice.call(m,0,-1)};var q=k.find("input");o?(p.addClass("erase"),q.attr("multiple","multiple")):(h.addClass("single"),h.on("click",function(){q[0].click()}),j.$formatters.push(function(a){return a&&!r(a)?[a]:a}),j.$parsers.push(function(a){return a[0]})),k.on("click",function(){event.stopPropagation()});var s=j.$bufferDefaults.$append;j.$bufferDefaults.$append=function(a){o||!o&&0===j.$viewValue.length?s(a):o||j.$bufferDefaults.$update(0,a)}}}}]);var H=a.module("nu.Show",[]);H.directive("nuShow",[function(){var b=function(){return a.element(arguments).toggleClass("active"),arguments[arguments.length-1]};return{template:'<div class="nu show"><a class="navigation right"><div class="arrow right"></div></a><a class="navigation left"><div class="arrow left"></div></a></div>',restrict:"EACM",replace:!0,require:"?ngModel",transclude:!0,link:function(c,d,e,f,g){var h,i,j=[],k=d[0];f&&c.$watchCollection(e.ngModel,function(c){if(a.isArray(c)&&c.length>0){a.forEach(c,function(b,c){h[c]||(h[c]=a.element("<img/>")[0]),h[c]&&h[c].parentNode!==k&&d.append(h[c]),a.element(h[c]).attr("src",b.src||b)});for(var e=c.length;e<h.length;e++)a.element(h[e]).remove();h=d.find("img"),i&&i.parentNode===k||(i=b(h[0]))}else a.element(h).remove()}),g(function(b){a.forEach(b,function(a){a.tagName&&"img"===a.tagName.toLowerCase()&&j.push(a)})}),d.append(j),h=d.find("img"),h&&h.length>0&&(i=b(h[0]));var l=[function(){i=b(i,i.nextSibling||h[0])},function(){i=b(i,"img"===i.previousSibling.tagName.toLowerCase()?i.previousSibling:h[h.length-1])}];a.forEach(d.find("a"),function(b,c){a.element(b).on("click",l[c])})}}}]);var I=a.module("nu.Slider",[]);I.service("_ScrollSize",["$window",function(b){var c,d,e=[],f=a.element('<div style="width:100px;height:100px;overflow:scroll;"><div style="width:200px;height:200px;"></div></div>'),g=function(a,b){var f=a[0],g=b[0];g.offsetWidth>=f.clientWidth&&!a.css("height")&&a.css({maxHeight:g.clientHeight+"px"}),e.push([f,g]),b.css({height:100+c/f.clientHeight*100+"%",width:100+d/f.clientWidth*100+"%"})};a.element(b).on("resize",function(){a.forEach(e,function(a){g.apply(null,a)})}),this.estimate=function(){a.element(b.document.body).append(f),c=f[0].offsetHeight-f[0].clientHeight,d=f[0].offsetWidth-f[0].clientWidth,f.remove()},this.height=function(){return c},this.width=function(){return d},this.hideBars=function(a,b){g(a,b)},this.estimate()}]),I.directive("nuSlider",["_ScrollSize",function(a){var b='<div class="nu slider"><div class="frame" style="overflow:scroll;"></div></div>';return{replace:!0,template:b,restrict:"EACM",transclude:!0,link:function(b,c,d,e,f){var g=c.css("overflow","hidden").find("div");g.append(f()),a.hideBars(c,g)}}}]);var J=a.module("nu.Event",[]);J.service("nuEvent",["$parse",function(a){var b=function(a,b){return function(c){a(b,{$event:c}),b.$digest()}},c=function(c,e){var f=function(c,e,f){f=f||"change click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste ",A.call(this),q(e,function(e,g){if(t(g)&&d(g,"nu")){var h=g.substr(2).toLowerCase();-1!==f.indexOf(h+" ")&&this.on(h,b(a(e),c))}},this)};return x(f.prototype,A.prototype),new f(c,e)};return c}]);var K=a.module("nu.Src",[]);K.directive("nuSrc",[function(){return{restrict:"AC",link:function(a,b,c){a.$watch(c.nuSrc,function(a){if(t(a))c.$set("src",a);else if(window.File&&window.FileReader&&a.name&&a.lastModifiedDate){var b=new FileReader;b.readAsDataURL(a),b.onload=function(a){c.$set("src",a.target.result)}}})}}}]);var L=a.module("nu.Wrap",[]),M="ws-view",N="ws-edit";L.run(["$templateCache",function(a){a.put("nu.wrap.default","<div><wrap-view>{{$model$}}</wrap-view><wrap-in></wrap-in></div>")}]);var O=function(a,b){var c=this;a.on("keydown",function(a){var b=a.which||a.keyCode;91===b||b>15&&19>b||b>=37&&40>=b||(c.$toAccept=!0)}),this.$accept=function(){c.$viewValue=a.val(),b.html(c.$viewValue||a.attr("placeholder")),c.$toAccept=!1},this.$reset=function(){a.val(b.html()!==a.attr("placeholder")?b.html():""),c.$toAccept=!1},this.isSimple=!0,this.$valid=!0},P={$template:"nu.wrap.default"},Q={$setDirty:p};L.directive("nuWrap",["$templateCache","$parse","$compile","$exceptionHandler","$animate",function(b,c,d,f,g){return{restrict:"AC",require:["?ngModel","^?form","^?wrapset"],priority:10,link:function(h,k,l,m){var o=k[0],p=a.element('<a class="w-view show-view"></a>'),r=m[0]||new O(k,p,w),s=m[1]||Q,t=m[2]||P,w=h.$new(!0),x=a.element(b.get(l.nuWrap||t.$template));x.length>1&&(x=a.element("<div></div>").append(x)),x.addClass("nu wrap ws-view"),p.html((x.find("wrap-view").html()||"{{$model$}}").replace("$model$","$viewValue")),x.find("wrap-view").replaceWith(p).length||x.prepend(p);var y=n.append.text(p[0],"");d(x)(w),k.addClass("show-editor w-edit"),o.parentNode.replaceChild(x[0],o),x[0].replaceChild(o,x.find("wrap-in")[0]);var A=function(a){var b=k.attr("placeholder");y.nodeValue=b&&a?b:""};if(r.$toAccept=!1,u(r.$setViewValue)){var B=c(l.ngModel),C=B.assign;w.$valid=r.$valid,w.$error=r.$error,w.$viewValue=r.$viewValue,w.$modelValue=r.$modelValue;var D=z(h,r,B(h),C),E=!1;D&&(D.get=function(a){if(r.$toAccept)return D.last;var b=D.exp(a);return w.$viewValue=r.$viewValue,w.$modelValue=r.$modelValue,A(!r.$viewValue||""===r.$viewValue),b}),r.$setViewValue=function(a){r.$viewValue=a,r.$toAccept=!0,r.$pristine&&(r.$dirty=!0,r.$pristine=!1,g.removeClass(k,i),g.addClass(k,j),s.$setDirty()),q(this.$parsers,function(b){a=b(a)}),w.$viewValue=r.$viewValue,r.$modelValue=w.$modelValue=a,w.$valid=r.$valid},r.$accept=function(){C(h,w.$modelValue),q(r.$viewChangeListeners,function(a){try{a()}catch(b){f(b)}}),r.$toAccept=!1,A(!r.$viewValue||""===r.$viewValue)},r.$reset=function(){r.$toAccept=!1;var a=D.exp(h);a||(r.$viewValue=r.$modelValue=a,k.val("")),w.$viewValue=r.$viewValue,w.$modelValue=r.$modelValue,w.$valid=r.$valid}}A(!k.val()),w.reset=r.$reset,w.accept=r.$accept,w.show=function(a){a!==E&&(r.$toAccept||(w.resetValue=r.$modelValue),x.removeClass(a?M:N).addClass(a?N:M),E=a)};var F=function(a){try{var b=a.which||a.keyCode;(13===b&&!a.ctrlKey||27===b)&&(r.$valid&&27!==b?r.$accept():r.$reset(),h.$digest(),w.show(!1))}catch(c){f(c)}};k.on("keydown",function(a){try{var b=a.which||a.keyCode;13===b&&!a.ctrlKey||27===b?a.preventDefault():r.$toAccept||b>15&&19>b||91===b||w.show(!0)}catch(c){f(c)}}),l.$observe("defaultNav",function(a){k[v(a)||e(a)?"on":"off"]("keyup",F)}),k.on("focus",function(){r.$toAccept||w.show(!0)}),p.on("focus",function(){k.focus()}),k.on("blur",function(){r.$toAccept||w.show(!1)}),p.on("mousedown",function(){w.show(!0),setTimeout(function(){o.focus()},0)})}}}]),L.filter("asterises",function(){return function(a,b){if(a){for(var c="",d=0;d<a.length;d++)c+=b||"â€¢";return c}return a}}),L.directive("wrapset",[function(){return{restrict:"EAC",controller:["$scope","$element","$attrs",function(a,b,c){this.$template=c.wrapset||c.tmpl}]}}]);a.module("nu.Wrap.bs",[]);L.run(["$templateCache",function(a){a.put("nu.wrap.bs.status",'<div class="input-group"><wrap-in></wrap-in><span class="input-group-addon show-editor"><span ng-class="{\'glyphicon-warning-sign\': !$valid, \'glyphicon-ok\': $valid}" class="glyphicon"></span></span></div>'),a.put("nu.wrap.bs.acceptReject",'<div class="input-group"><wrap-in></wrap-in><span class="input-group-addon show-editor" ng-click="$valid && accept(); show(!$valid);"><span class="glyphicon" ng-class="{\'glyphicon-warning-sign\': !$valid, \'glyphicon-ok\': $valid}"></span></span><span class="input-group-addon show-editor" ng-click="reset(); show(false);"><span class="glyphicon glyphicon-remove"></span></span></div>')}]);var R={};R.audio=".adp .au .snd .mid .midi .kar .rmi .mp4a .mpga .mp2 .mp2a .mp3 .m2a .m3a .oga .ogg .spx .s3m .sil .uva .uvva .eol .dra .dts .dtshd .lvp .pya .ecelp4800 .ecelp7470 .ecelp9600 .rip .weba .aac .aif .aiff .aifc .caf .flac .mka .m3u .wax .wma .ram .ra .rmp .wav .xm",R.image=".bmp .cgm .g3 .gif .ief .jpeg .jpg .jpe .ktx .png .btif .sgi .svg .svgz .tiff .tif .psd .uvi .uvvi .uvg .uvvg .sub .djvu .djv .dwg .dxf .fbs .fpx .fst .mmr .rlc .mdi .wdp .npx .wbmp .xif .webp .3ds .ras .cmx .fh .fhc .fh4 .fh5 .fh7 .ico .sid .pcx .pic .pct .pnm .pbm .pgm .ppm .rgb .tga .xbm .xpm .xwd",R.video=".3gp .3g2 .h261 .h263 .h264 .jpgv .jpm .jpgm .mj2 .mjp2 .mp4 .mp4v .mpg4 .mpeg .mpg .mpe .m1v .m2v .ogv .qt .mov .uvh .uvvh .uvm .uvvm .uvp .uvvp .uvs .uvvs .uvv .uvvv .dvb .fvt .mxu .m4u .pyv .uvu .uvvu .viv .webm .f4v .fli .flv .m4v .mkv .mk3d .mks .mng .asf .asx .vob .wm .wmv .wmx .wvx .avi .movie .smv";var S=(h("audio"),h("image"),h("video"),a.module("nu.Media",[]));S.service("nuMedia",["$q",function(b){var c=function(b){function c(a,b){if(h.$deferred.notify){var c={};c[a]=b,h.$deferred.notify(c)}}var e=this.$el=a.element("<"+b+"/>"),g=this.el=e[0];this.available=!!g.canPlayType,a.element(document.body).append(e.css("display","none")),this.toSource=function(b,c){if("source"===w(b.tagName))return b;var d,e;if(f(b)){if(!g.canPlayType(b.type))return;d=URL.createObjectURL(b),e=b.type}if(s(b)&&b.src&&(b.type?(d=b.src,e=b.type):b=b.src),t(b)&&(d=b),c&&(d+="#t="+c),d){var h=a.element("<source/>").attr("src",d);return e&&h.attr("type",e),h}};var h=this;e.on("error emptied abort",function(){}),e.on("loadedmetadata",function(){h.$deferred.promise.media={duration:h.el.duration,uri:h.$el.find("source").attr("src")}}),this.onStop=function(){var a=h.current,b=h.el.currentTime===h.el.duration;h.$deferred&&h.$deferred.promise.media&&d(h.$deferred.promise.media.uri,"blob:")&&URL.revokeObjectURL(h.$deferred.promise.media.uri),h.current=null,h.$el.attr("src","").removeAttr("src").html(""),h.$deferred.resolve&&h.$deferred.resolve({end:{target:a,completed:b}})},e.on("ended",this.onStop),e.on("timeupdate durationchange",function(a){c("duration",{duration:a.target.currentTime,currentTime:a.target.duration,progress:a.target.currentTime/a.target.duration})})};c.prototype.play=function(a,c){if(this.current===a||v(a)&&this.el.duration)return this.el.play(),this.$deferred.promise;var d;if(f(a)||t(a))d=this.toSource(a,c);else if(s(a))for(var e in a)if(d=this.toSource(a[e],c))break;return d&&(this.stop(),this.$deferred=b.defer(),this.$el.append(d),this.el.play(),this.current=a),this.$deferred.promise},c.prototype.pause=function(){return this.el.duration?(this.el.pause(),this.current):void 0},c.prototype.stop=function(){this.el.duration&&(this.pause(),this.onStop())},c.prototype.seek=function(){},c.prototype.canPlay=function(a){return this.el.canPlayType(a.type||a)};var e=new c("audio"),g=new c("video"),h={audio:e,video:g};return h.typeOf=function(a){if(f(a)){if(d(a.type,"audio"))return"audio";if(d(a.type,"video"))return"audio";if(d(a.type,"image"))return"image";a=a.name}if(t(a)){var b=o.splitext(a)[1];if(b)for(var c in R)if("."===b[0]&&-1!==R[c].indexOf(b))return c}},h}]),S.run(["$templateCache",function(a){a.put("nu.button.view.icon.coin",'<div class="icon play"><div class="icon-inner"></div></div>'),a.put("nu.button.view.progress.coin",'<div class="progress"><div class="progress-inner"></div></div>'),a.put("nu.button.view.icon.box",'<div class="icon play"><div class="icon-inner"></div></div>'),a.put("nu.button.view.progress.box",'<div class="progress"><div class="progress-inner"></div></div>')}]);var T=a.module("nu.ButtonView",["nu.Media"]);T.service("nuButtonViewTypes",["$templateCache",function(b){var c={setIcon:function(a){this.removeIcon(),a&&this.el.icon.addClass(a)},removeIcon:function(){this.el.icon.removeClass("image replay play pause stop")},progressReset:function(){this.progressUpdate({duration:{progress:0}})}},d={coin:function(c){this.el={},this.el.icon=a.element(b.get("nu.button.view.icon.coin")),this.el.progress=a.element(b.get("nu.button.view.progress.coin"));var d=this;c.append(this.el.icon).append(this.el.progress),this.progressUpdate=function(a){if(a.duration){var b="rotate("+(a.duration.progress+.12)+"turn)";d.el.progress.css({"-webkit-transform":b,"-moz-transform":b,transform:b})}}},box:function(c){this.el={},this.el.icon=a.element(b.get("nu.button.view.icon.box")),this.el.progress=a.element(b.get("nu.button.view.progress.box"));var d=this;c.append(this.el.icon).append(this.el.progress);var e=this.el.progress[0];this.progressUpdate=function(a){a.duration&&d.el.progress.css("box-shadow","inset "+Math.floor(e.clientWidth*a.duration.progress)+"px 0px 0px 0px rgba(53, 126, 189, 0.5)")}},fcbox:function(c){this.el={},this.el.icon=a.element(b.get("nu.button.view.icon.box")),this.el.progress=c.parent();var d=this;c.append(this.el.icon);var e=this.el.progress[0];this.progressUpdate=function(a){a.duration&&d.el.progress.css("box-shadow","inset "+Math.floor(e.clientWidth*a.duration.progress)+"px 0px 4px 0px rgba(53, 126, 189, 1)")},this.progressReset=function(){d.el.progress.css("box-shadow","none")}}};x(d.coin.prototype,c),x(d.box.prototype,c),x(d.fcbox.prototype,c);var e={bind:function(a,b){return new d[a](b)},defaultIcon:{audio:"play",image:"image"}};return e.defaultIcon.video=e.defaultIcon.audio,e}]),T.directive("nuButtonView",["nuMedia","nuButtonViewTypes",function(a,c){var d='<div class="nu button view"><input type="radio" style="display: none;"/></div>';return{template:d,restrict:"EACM",replace:!0,require:"?ngModel",link:function(d,e,f,g){function h(a){n&&(a.end&&(m.setIcon(a.end.completed?"replay":"play"),m.progressReset()),n=!1)}function i(){n?a.audio.pause():a.audio.play(g.$viewValue).then(h,h,m.progressUpdate),n=!n,m.setIcon(n?"pause":"play")}function j(){}var k,l=f.nuButtonView||"coin",m=c.bind(l,e),n=!1,o=!1,p=!1;e.addClass(l),g.$render=function(){n&&a[k]&&a[k].stop(),m.progressReset(),k=a.typeOf(g.$viewValue),b(k)&&(o=p=!1,p="image"===k,o=!p),m.setIcon(c.defaultIcon[k])},e.on("click",function(){o?i():p&&j(),event.stopPropagation()})}}}]);a.module("nu",["nu.Switch","nu.PressButton","nu.List","nu.FileChooser","nu.Show","nu.Src","nu.Slider","nu.Wrap"])}(angular);